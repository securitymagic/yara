/*
 This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as long as you use it under this license.

 February/March Solarmarker HEX string observations for the in-memory DLL that is loaded from powershell.
 
 Written by Luke Acha
 https://www.lukeacha.com/
 https://security5magics.blogspot.com/
  
*/
rule solarmarker_offsets
{
  strings:
  	  $mz = "MZ"
      $hex1 = { 59 d1 8c ?? 00 00 }
      $hex2 = { 6c 58 11 07 6c 58 }
      $hex3 = { 6c 5a 58 11 5c }
      $unique_string = "dzkabr" wide
  condition:
     ($hex1 in (0x1990..0x19b0) and $hex2 and $hex3 and $mz at 0) or ( $unique_string)
}
